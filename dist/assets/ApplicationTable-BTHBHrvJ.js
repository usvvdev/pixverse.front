import{_ as E}from"./AddAccountButton.vue_vue_type_script_setup_true_lang-C8577MT8.js";import{_ as L,a as B,b as M,c as z}from"./ComponentCard.vue_vue_type_script_setup_true_lang-B17U38ib.js";import{r as i,u as A,o as N,a as o,c as l,b as e,F as w,i as $,w as h,v as k,h as d,t as m,k as P,d as R,l as q,m as _,p}from"./index-DJvXe5fk.js";const O={class:"overflow-hidden rounded-xl border border-gray-200 bg-white dark:border-gray-800 dark:bg-white/[0.03]"},G={class:"max-w-full overflow-x-auto custom-scrollbar"},H={class:"min-w-full"},J={class:"divide-y divide-gray-200 dark:divide-gray-700"},K={class:"px-5 py-4 sm:px-6 text-theme-sm text-gray-800 dark:text-white/90"},Q={class:"px-5 py-4 sm:px-6 text-theme-sm text-gray-600 dark:text-gray-400"},W={class:"px-5 py-4 sm:px-6"},X={class:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4"},Y=["src"],Z={class:"text-center"},ee={class:"text-xs font-medium text-gray-700 dark:text-white truncate"},te={class:"text-xs text-gray-500 dark:text-gray-400 truncate"},se={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},re={class:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},ae={class:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full dark:bg-gray-800"},oe={class:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4 dark:bg-gray-800"},le={class:"space-y-4"},ie={class:"mt-1 flex items-center"},de=["src"],ne=["src"],ue={class:"mt-1 flex items-center"},me=["src"],ce=["src"],ge={key:1,class:"fixed inset-0 z-50 overflow-y-auto"},pe={class:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},fe={class:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full dark:bg-gray-800"},ye={class:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse dark:bg-gray-800"},be=["disabled"],ve={key:0},xe={key:1},we={__name:"BasicTableFour",setup(V){const n=i([]),f=i(!1),y=i(!1),b=i(null),a=i({id:null,name:"",category:"",prompt:"",is_active:"",preview_small:null,preview_large:null}),D=i(null),F=i(null),C=i(!1),c=i(!1),g=A(),T=async()=>{try{const s=await fetch("/dashboard/api/v1/applications");if(!s.ok)throw new Error("Failed to fetch templates");n.value=await s.json()}catch(s){console.error("Error fetching templates:",s)}},v=()=>{f.value=!1},j=async()=>{C.value=!0;try{const s=new FormData;s.append("name",a.value.name),s.append("template_id",a.value.template_id),F.value?s.append("preview",F.value):!a.value.preview&&!D.value&&s.append("remove_preview","true");const t=localStorage.getItem("accessToken"),r=await fetch(`/dashboard/api/v1/templates/${a.value.id}`,{method:"PUT",body:s,headers:{Authorization:`Bearer ${t}`}});if(!r.ok)if(r.status===401){if(await g.refresh())return await retryOriginalRequest();g.logout(),router.push("/")}else console.error("Ошибка запроса:",await r.json());const u=await r.json(),U=n.value.findIndex(S=>S.id===a.value.id);U!==-1&&(n.value[U]=u),v()}catch(s){console.error("Error updating style:",s)}finally{C.value=!1}},x=()=>{y.value=!1,b.value=null},I=async()=>{c.value=!0;try{const s=localStorage.getItem("accessToken"),t=await fetch(`/dashboard/api/v1/templates/${b.value}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}});if(!t.ok)if(t.status===401){if(await g.refresh())return await retryOriginalRequest();g.logout(),router.push("/")}else console.error("Ошибка запроса:",await t.json());n.value=n.value.filter(r=>r.id!==b.value),x()}catch(s){console.error("Error deleting style:",s)}finally{c.value=!1}};return N(()=>{T()}),(s,t)=>(o(),l(w,null,[e("div",O,[e("div",G,[e("table",H,[t[9]||(t[9]=e("thead",null,[e("tr",{class:"border-b border-gray-200 dark:border-gray-700"},[e("th",{class:"px-5 py-3 text-left sm:px-6"},"ID"),e("th",{class:"px-5 py-3 text-left sm:px-6"},"App ID"),e("th",{class:"px-5 py-3 text-left sm:px-6"},"Templates")])],-1)),e("tbody",J,[(o(!0),l(w,null,$(n.value,r=>(o(),l("tr",{key:r.id,class:"border-t border-gray-100 dark:border-gray-800"},[e("td",K,m(r.id),1),e("td",Q,m(r.app_id),1),e("td",W,[e("div",X,[(o(!0),l(w,null,$(r.templates,u=>(o(),l("div",{key:u.name,class:"flex flex-col items-center gap-2"},[u.preview_small?(o(),l("video",{key:0,src:u.preview_small,controls:"",class:"w-24 h-16 rounded shadow"},null,8,Y)):d("",!0),e("div",Z,[e("p",ee,m(u.name),1),e("p",te,m(u.category),1)])]))),128))])])]))),128))])])])]),f.value?(o(),l("div",se,[e("div",re,[e("div",{class:"fixed inset-0 transition-opacity","aria-hidden":"true",onClick:v},t[10]||(t[10]=[e("div",{class:"absolute inset-0 bg-gray-500 opacity-75 dark:bg-gray-900 dark:opacity-75"},null,-1)])),t[17]||(t[17]=e("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"​",-1)),e("div",ae,[e("div",oe,[t[16]||(t[16]=e("h3",{class:"text-lg leading-6 font-medium text-gray-900 dark:text-white mb-4"},"Изменить стиль",-1)),e("div",le,[e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Name",-1)),h(e("input",{"onUpdate:modelValue":t[0]||(t[0]=r=>a.value.name=r),type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm"},null,512),[[k,a.value.name]])]),e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Category",-1)),h(e("input",{"onUpdate:modelValue":t[1]||(t[1]=r=>a.value.category=r),type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm"},null,512),[[k,a.value.category]])]),e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Prompt",-1)),h(e("input",{"onUpdate:modelValue":t[2]||(t[2]=r=>a.value.prompt=r),type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm"},null,512),[[k,a.value.prompt]])]),e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Preview Small",-1)),e("div",ie,[a.value.preview_small&&!s.previewSmallFile?(o(),l("video",{key:0,src:a.value.preview_small,class:"h-20 w-20 rounded mr-4",controls:""},null,8,de)):d("",!0),s.previewSmallFileUrl?(o(),l("video",{key:1,src:s.previewSmallFileUrl,class:"h-20 w-20 rounded mr-4",controls:""},null,8,ne)):d("",!0),e("input",{type:"file",ref:"smallFileInput",accept:"video/*",onChange:t[3]||(t[3]=r=>s.handleVideoUpload(r,"small")),class:"hidden"},null,544),e("button",{type:"button",onClick:t[4]||(t[4]=r=>s.$refs.smallFileInput.click()),class:"ml-3 bg-white py-2 px-3 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"},m(a.value.preview_small||s.previewSmallFileUrl?"Change Video":"Upload Video"),1),a.value.preview_small||s.previewSmallFileUrl?(o(),l("button",{key:2,type:"button",onClick:t[5]||(t[5]=r=>s.removeVideo("small")),class:"ml-3 bg-white py-2 px-3 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"}," Remove ")):d("",!0)])]),e("div",null,[t[15]||(t[15]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Preview Large",-1)),e("div",ue,[a.value.preview_large&&!s.previewLargeFile?(o(),l("video",{key:0,src:a.value.preview_large,class:"h-20 w-20 rounded mr-4",controls:""},null,8,me)):d("",!0),s.previewLargeFileUrl?(o(),l("video",{key:1,src:s.previewLargeFileUrl,class:"h-20 w-20 rounded mr-4",controls:""},null,8,ce)):d("",!0),e("input",{type:"file",ref:"largeFileInput",accept:"video/*",onChange:t[6]||(t[6]=r=>s.handleVideoUpload(r,"large")),class:"hidden"},null,544),e("button",{type:"button",onClick:t[7]||(t[7]=r=>s.$refs.largeFileInput.click()),class:"ml-3 bg-white py-2 px-3 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"},m(a.value.preview_large||s.previewLargeFileUrl?"Change Video":"Upload Video"),1),a.value.preview_large||s.previewLargeFileUrl?(o(),l("button",{key:2,type:"button",onClick:t[8]||(t[8]=r=>s.removeVideo("large")),class:"ml-3 bg-white py-2 px-3 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"}," Remove ")):d("",!0)])])]),e("button",{type:"button",onClick:j,class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm"}," Сохранить "),e("button",{type:"button",onClick:v,class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm dark:bg-gray-700 dark:text-white dark:border-gray-600 dark:hover:bg-gray-600"}," Отменить ")])])])])):d("",!0),y.value?(o(),l("div",ge,[e("div",pe,[e("div",{class:"fixed inset-0 transition-opacity","aria-hidden":"true",onClick:x},t[18]||(t[18]=[e("div",{class:"absolute inset-0 bg-gray-500 opacity-75 dark:bg-gray-900 dark:opacity-75"},null,-1)])),t[20]||(t[20]=e("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"​",-1)),e("div",fe,[t[19]||(t[19]=P('<div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4 dark:bg-gray-800" data-v-6ac089ec><div class="sm:flex sm:items-start" data-v-6ac089ec><div class="mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10" data-v-6ac089ec><svg class="h-6 w-6 text-red-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true" data-v-6ac089ec><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" data-v-6ac089ec></path></svg></div><div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left" data-v-6ac089ec><h3 class="text-lg leading-6 font-medium text-gray-900 dark:text-white" data-v-6ac089ec>Удалить шаблон</h3><div class="mt-2" data-v-6ac089ec><p class="text-sm text-gray-500 dark:text-gray-400" data-v-6ac089ec>Вы уверены, что хотите удалить шаблон? Это действие будет невозвратно.</p></div></div></div></div>',1)),e("div",ye,[e("button",{type:"button",onClick:I,disabled:c.value,class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed"},[c.value?(o(),l("span",ve,"Deleting...")):(o(),l("span",xe,"Delete"))],8,be),e("button",{type:"button",onClick:x,class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm dark:bg-gray-700 dark:text-white dark:border-gray-600 dark:hover:bg-gray-600"}," Cancel ")])])])])):d("",!0)],64))}},he=L(we,[["__scopeId","data-v-6ac089ec"]]),ke={class:"space-y-5 sm:space-y-6"},Ue=R({__name:"ApplicationTable",setup(V){const n=i("Приложения");return(f,y)=>(o(),q(z,null,{default:_(()=>[p(B,{pageTitle:n.value},null,8,["pageTitle"]),e("div",ke,[p(M,{title:"Приложения"},{action:_(()=>[p(E)]),default:_(()=>[p(he)]),_:1})])]),_:1}))}});export{Ue as default};
