import{_ as P,c as U,a as F,b as N}from"./ComponentCard.vue_vue_type_script_setup_true_lang-DEzwKHB0.js";import{r as d,u as R,o as O,a as o,c as l,b as e,F as j,g as q,w as D,v as I,h as g,t as p,i as H,j as G,k as T,l as _}from"./index-C5U0NRT1.js";const J={class:"overflow-hidden rounded-xl border border-gray-200 bg-white dark:border-gray-800 dark:bg-white/[0.03]"},K={class:"max-w-full overflow-x-auto custom-scrollbar"},Q={class:"min-w-full"},W={class:"divide-y divide-gray-200 dark:divide-gray-700"},X={class:"px-5 py-4 sm:px-6"},Y={class:"block font-medium text-gray-800 text-theme-sm dark:text-white/90"},Z={class:"px-5 py-4 sm:px-6"},ee={class:"text-gray-500 text-theme-sm dark:text-gray-400"},te={class:"px-5 py-4 sm:px-6 max-w-[200px]"},se={class:"text-gray-500 text-theme-sm dark:text-gray-400 truncate whitespace-nowrap overflow-hidden"},ae={class:"px-5 py-4 sm:px-6"},re={class:"text-gray-500 text-theme-sm dark:text-gray-400"},oe={class:"px-5 py-4 sm:px-6"},le=["src","onClick"],de={class:"px-5 py-4 sm:px-6"},ne={class:"flex items-center space-x-2"},ie=["onClick"],ce=["onClick"],ue={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},me={class:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},ge={class:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full dark:bg-gray-800"},pe={class:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4 dark:bg-gray-800"},xe={class:"space-y-4"},fe={class:"mt-1 flex items-center"},ve=["src"],ye=["src"],be={class:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse dark:bg-gray-800"},he=["disabled"],we={key:0},ke={key:1},_e={key:1,class:"fixed inset-0 z-50 overflow-y-auto"},Ce={class:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},je={class:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full dark:bg-gray-800"},De={class:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse dark:bg-gray-800"},Ie=["disabled"],Te={key:0},Se={key:1},$e={__name:"BasicTableTwo",setup(S){const n=d([]),x=d(!1),f=d(!1),v=d(null),r=d({id:null,name:"",template_id:"",preview:null}),i=d(null),c=d(null),y=d(!1),b=d(!1),h=R(),$=async()=>{try{const s=await fetch("/dashboard/api/v1/templates");if(!s.ok)throw new Error("Failed to fetch styles");n.value=await s.json()}catch(s){console.error("Error fetching styles:",s)}},E=s=>{r.value={id:s.id,name:s.name,template_id:s.template_id,preview:s.preview},i.value=null,c.value=null,x.value=!0},w=()=>{x.value=!1},M=s=>{const t=s.target.files[0];if(t){c.value=t;const a=new FileReader;a.onload=u=>{i.value=u.target.result},a.readAsDataURL(t)}},B=()=>{r.value.preview=null,i.value=null,c.value=null},z=async()=>{y.value=!0;try{const s=new FormData;s.append("name",r.value.name),s.append("template_id",r.value.template_id),c.value?s.append("preview",c.value):!r.value.preview&&!i.value&&s.append("remove_preview","true");const t=localStorage.getItem("accessToken"),a=await fetch(`/dashboard/api/v1/template/${r.value.id}`,{method:"PUT",body:s,headers:{Authorization:`Bearer ${t}`}});if(!a.ok)if(a.status===401){if(await h.refresh())return await retryOriginalRequest();h.logout(),router.push("/")}else console.error("Ошибка запроса:",await a.json());const u=await a.json(),m=n.value.findIndex(C=>C.id===r.value.id);m!==-1&&(n.value[m]=u),w()}catch(s){console.error("Error updating style:",s)}finally{y.value=!1}},V=s=>{v.value=s,f.value=!0},k=()=>{f.value=!1,v.value=null},A=async()=>{b.value=!0;try{const s=localStorage.getItem("accessToken"),t=await fetch(`/dashboard/api/v1/template/${v.value}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}});if(!t.ok)if(t.status===401){if(await h.refresh())return await retryOriginalRequest();h.logout(),router.push("/")}else console.error("Ошибка запроса:",await t.json());n.value=n.value.filter(a=>a.id!==v.value),k()}catch(s){console.error("Error deleting style:",s)}finally{b.value=!1}},L=s=>{window.open(s,"_blank")};return O(()=>{$()}),(s,t)=>(o(),l(j,null,[e("div",J,[e("div",K,[e("table",Q,[t[5]||(t[5]=e("thead",null,[e("tr",{class:"border-b border-gray-200 dark:border-gray-700"},[e("th",{class:"px-5 py-3 text-left w-3/11 sm:px-6"},[e("p",{class:"font-medium text-gray-500 text-theme-xs dark:text-gray-400"},"ID")]),e("th",{class:"px-5 py-3 text-left w-2/11 sm:px-6"},[e("p",{class:"font-medium text-gray-500 text-theme-xs dark:text-gray-400"},"Name")]),e("th",{class:"px-5 py-3 text-left w-2/11 sm:px-6"},[e("p",{class:"font-medium text-gray-500 text-theme-xs dark:text-gray-400"},"Prompt")]),e("th",{class:"px-5 py-3 text-left w-2/11 sm:px-6"},[e("p",{class:"font-medium text-gray-500 text-theme-xs dark:text-gray-400"},"Category")]),e("th",{class:"px-5 py-3 text-left w-2/11 sm:px-6"},[e("p",{class:"font-medium text-gray-500 text-theme-xs dark:text-gray-400"},"Preview")]),e("th",{class:"px-5 py-3 text-left w-2/11 sm:px-6"},[e("p",{class:"font-medium text-gray-500 text-theme-xs dark:text-gray-400"},"Actions")])])],-1)),e("tbody",W,[(o(!0),l(j,null,q(n.value,(a,u)=>(o(),l("tr",{key:u,class:"border-t border-gray-100 dark:border-gray-800"},[e("td",X,[e("span",Y,p(a.id),1)]),e("td",Z,[e("p",ee,p(a.name),1)]),e("td",te,[e("p",se,p(a.prompt),1)]),e("td",ae,[e("p",re,p(a.category),1)]),e("td",oe,[e("img",{src:a.preview_small,alt:"Preview",class:"max-w-[300px] max-h-[auto] object-cover rounded",onClick:m=>L(a.preview_small)},null,8,le)]),e("td",de,[e("div",ne,[e("button",{onClick:m=>E(a),class:"p-1 text-gray-500 hover:text-blue-600 dark:text-gray-400 dark:hover:text-blue-400"},t[3]||(t[3]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"})],-1)]),8,ie),e("button",{onClick:m=>V(a.id),class:"p-1 text-gray-500 hover:text-red-600 dark:text-gray-400 dark:hover:text-red-400"},t[4]||(t[4]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z","clip-rule":"evenodd"})],-1)]),8,ce)])])]))),128))])])])]),x.value?(o(),l("div",ue,[e("div",me,[e("div",{class:"fixed inset-0 transition-opacity","aria-hidden":"true",onClick:w},t[6]||(t[6]=[e("div",{class:"absolute inset-0 bg-gray-500 opacity-75 dark:bg-gray-900 dark:opacity-75"},null,-1)])),t[11]||(t[11]=e("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"​",-1)),e("div",ge,[e("div",pe,[t[10]||(t[10]=e("h3",{class:"text-lg leading-6 font-medium text-gray-900 dark:text-white mb-4"}," Edit Style ",-1)),e("div",xe,[e("div",null,[t[7]||(t[7]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Name",-1)),D(e("input",{"onUpdate:modelValue":t[0]||(t[0]=a=>r.value.name=a),type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm"},null,512),[[I,r.value.name]])]),e("div",null,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Template ID",-1)),D(e("input",{"onUpdate:modelValue":t[1]||(t[1]=a=>r.value.template_id=a),type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white sm:text-sm"},null,512),[[I,r.value.template_id]])]),e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Preview Image",-1)),e("div",fe,[r.value.preview&&!c.value?(o(),l("img",{key:0,src:r.value.preview,class:"h-20 w-20 object-cover rounded mr-4"},null,8,ve)):g("",!0),i.value?(o(),l("img",{key:1,src:i.value,class:"h-20 w-20 object-cover rounded mr-4"},null,8,ye)):g("",!0),e("input",{type:"file",ref:"fileInput",accept:"image/*",onChange:M,class:"hidden"},null,544),e("button",{type:"button",onClick:t[2]||(t[2]=a=>s.$refs.fileInput.click()),class:"ml-3 bg-white py-2 px-3 border border-gray-300 rounded-md shadow-sm text-sm leading-4 font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"},p(r.value.preview||i.value?"Change Image":"Upload Image"),1),r.value.preview||i.value?(o(),l("button",{key:2,type:"button",onClick:B,class:"ml-3 bg-white py-2 px-3 border border-gray-300 rounded-md shadow-sm text-sm leading-4 font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white"}," Remove ")):g("",!0)])])])]),e("div",be,[e("button",{type:"button",onClick:z,disabled:y.value,class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed"},[y.value?(o(),l("span",we,"Saving...")):(o(),l("span",ke,"Save"))],8,he),e("button",{type:"button",onClick:w,class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm dark:bg-gray-700 dark:text-white dark:border-gray-600 dark:hover:bg-gray-600"}," Cancel ")])])])])):g("",!0),f.value?(o(),l("div",_e,[e("div",Ce,[e("div",{class:"fixed inset-0 transition-opacity","aria-hidden":"true",onClick:k},t[12]||(t[12]=[e("div",{class:"absolute inset-0 bg-gray-500 opacity-75 dark:bg-gray-900 dark:opacity-75"},null,-1)])),t[14]||(t[14]=e("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"​",-1)),e("div",je,[t[13]||(t[13]=H('<div class="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4 dark:bg-gray-800" data-v-b0da6cf8><div class="sm:flex sm:items-start" data-v-b0da6cf8><div class="mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10" data-v-b0da6cf8><svg class="h-6 w-6 text-red-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true" data-v-b0da6cf8><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" data-v-b0da6cf8></path></svg></div><div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left" data-v-b0da6cf8><h3 class="text-lg leading-6 font-medium text-gray-900 dark:text-white" data-v-b0da6cf8> Delete Style </h3><div class="mt-2" data-v-b0da6cf8><p class="text-sm text-gray-500 dark:text-gray-400" data-v-b0da6cf8> Are you sure you want to delete this style? This action cannot be undone. </p></div></div></div></div>',1)),e("div",De,[e("button",{type:"button",onClick:A,disabled:b.value,class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed"},[b.value?(o(),l("span",Te,"Deleting...")):(o(),l("span",Se,"Delete"))],8,Ie),e("button",{type:"button",onClick:k,class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm dark:bg-gray-700 dark:text-white dark:border-gray-600 dark:hover:bg-gray-600"}," Cancel ")])])])])):g("",!0)],64))}},Ee=P($e,[["__scopeId","data-v-b0da6cf8"]]),Me={class:"space-y-5 sm:space-y-6"},Ve={__name:"TemplateTable",setup(S){const n=d("Шаблоны для генерации Pixverse");return(x,f)=>(o(),G(U,null,{default:T(()=>[_(F,{pageTitle:n.value},null,8,["pageTitle"]),e("div",Me,[_(N,{title:"Шаблоны"},{default:T(()=>[_(Ee)]),_:1})])]),_:1}))}};export{Ve as default};
