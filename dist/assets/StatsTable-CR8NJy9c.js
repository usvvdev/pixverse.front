import{_ as B,a as I,b as S}from"./ComponentCard.vue_vue_type_script_setup_true_lang-CswAMQAf.js";import{d as b,r as l,o as F,a,c as r,b as t,w as _,n as f,F as p,i as x,t as o,p as T,q as U,h as v,g as m}from"./index-B0_3lMEf.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const E={class:"mb-4 flex flex-wrap gap-4 items-center"},V=["value"],j=["value"],C={class:"overflow-hidden rounded-xl border border-gray-200 bg-white dark:border-gray-800 dark:bg-white/[0.03]"},D={class:"max-w-full overflow-x-auto custom-scrollbar"},N={class:"min-w-full"},z={class:"divide-y divide-gray-200 dark:divide-gray-700"},G={class:"px-5 py-4 sm:px-6 text-theme-sm"},L={class:"block font-medium text-gray-800 dark:text-white/90"},M={class:"px-5 py-4 sm:px-6 text-theme-sm text-gray-600 dark:text-gray-400"},P={class:"px-5 py-4 sm:px-6 text-theme-sm text-gray-600 dark:text-gray-400"},q={class:"px-5 py-4 sm:px-6 text-theme-sm text-gray-600 dark:text-gray-400"},R={class:"px-5 py-4 sm:px-6 text-theme-sm text-gray-600 dark:text-gray-400"},H={class:"flex items-center space-x-2"},J=["src","alt"],K={key:0,class:"flex items-center justify-center w-12 h-12 rounded-lg bg-gray-100 text-xs text-gray-500 dark:bg-gray-700 dark:text-gray-300"},O=b({__name:"BasicTableFive",setup(k){const i=l([]),d=l(""),n=l(""),u=l([]),g=l([]),y=async()=>{const c=localStorage.getItem("accessToken");try{const s=new URLSearchParams;d.value&&s.append("user_id",d.value),n.value&&s.append("app_id",n.value);const e=await fetch(`/dashboard/api/v1/statistics?app_name=chatgpt&${s.toString()}`,{headers:{Authorization:`Bearer ${c}`}});if(!e.ok)throw new Error("Failed to fetch statistics");i.value=await e.json()}catch(s){console.error("Error fetching statistics:",s)}},w=async()=>{const c=localStorage.getItem("accessToken");try{const s=await fetch("/dashboard/api/v1/statistics/filters?app_name=chatgpt",{headers:{Authorization:`Bearer ${c}`}});if(!s.ok)throw new Error("Failed to fetch filters");const e=await s.json();u.value=e.user_ids??[],g.value=e.app_ids??[]}catch(s){console.error("Error fetching filter options:",s)}};return F(async()=>{await w(),await y()}),(c,s)=>(a(),r("div",null,[t("div",E,[_(t("select",{"onUpdate:modelValue":s[0]||(s[0]=e=>d.value=e),class:"px-3 py-2 border rounded-md text-sm w-48 dark:bg-gray-900 dark:text-white"},[s[2]||(s[2]=t("option",{value:""},"All Users",-1)),(a(!0),r(p,null,x(u.value,e=>(a(),r("option",{key:e,value:e},o(e),9,V))),128))],512),[[f,d.value]]),_(t("select",{"onUpdate:modelValue":s[1]||(s[1]=e=>n.value=e),class:"px-3 py-2 border rounded-md text-sm w-48 dark:bg-gray-900 dark:text-white"},[s[3]||(s[3]=t("option",{value:""},"All Apps",-1)),(a(!0),r(p,null,x(g.value,e=>(a(),r("option",{key:e,value:e},o(e),9,j))),128))],512),[[f,n.value]]),t("button",{onClick:y,class:"px-4 py-2 bg-blue-600 text-white text-sm rounded-md hover:bg-blue-700"}," Apply Filters ")]),t("div",C,[t("div",D,[t("table",N,[s[4]||(s[4]=t("thead",null,[t("tr",{class:"border-b border-gray-200 dark:border-gray-700"},[t("th",{class:"px-5 py-3 text-left w-2/12 sm:px-6"},[t("p",{class:"font-medium text-gray-500 text-theme-xs dark:text-gray-400"},"User ID")]),t("th",{class:"px-5 py-3 text-left w-2/12 sm:px-6"},[t("p",{class:"font-medium text-gray-500 text-theme-xs dark:text-gray-400"},"App ID")]),t("th",{class:"px-5 py-3 text-left w-1/12 sm:px-6"},[t("p",{class:"font-medium text-gray-500 text-theme-xs dark:text-gray-400"},"Usage")]),t("th",{class:"px-5 py-3 text-left w-1/12 sm:px-6"},[t("p",{class:"font-medium text-gray-500 text-theme-xs dark:text-gray-400"},"Balance")]),t("th",{class:"px-5 py-3 text-left w-3/12 sm:px-6"},[t("p",{class:"font-medium text-gray-500 text-theme-xs dark:text-gray-400"},"Generations")])])],-1)),t("tbody",z,[(a(!0),r(p,null,x(i.value,(e,$)=>(a(),r("tr",{key:$,class:"border-t border-gray-100 dark:border-gray-800"},[t("td",G,[t("span",L,o(e.user_id),1)]),t("td",M,o(e.app_id),1),t("td",P,o(e.app_id_usage),1),t("td",q,o(e.balance),1),t("td",R,[t("div",H,[(a(!0),r(p,null,x(e.generation_ids.slice(0,3),(A,h)=>(a(),r("div",{key:h,class:"w-12 h-12 overflow-hidden rounded-lg border border-gray-200 dark:border-gray-700"},[t("img",{src:A,alt:`Generation ${h+1}`,class:"w-full h-full object-cover"},null,8,J)]))),128)),e.generation_ids.length>3?(a(),r("div",K," +"+o(e.generation_ids.length-3),1)):T("",!0)])])]))),128))])])])])]))}}),Q={class:"space-y-5 sm:space-y-6"},Z=b({__name:"StatsTable",setup(k){const i=l("Статистика пользователей");return(d,n)=>(a(),U(S,null,{default:v(()=>[m(B,{pageTitle:i.value},null,8,["pageTitle"]),t("div",Q,[m(I,{title:"Статистика"},{default:v(()=>[m(O)]),_:1})])]),_:1}))}});export{Z as default};
