import{d as V,a as v,c as y,b as e,t as x,l as N,m as M,e as E,w as d,v as c,n as R,p as I,u as z,r as $,o as O,g as A,h as S,k as U,F as P,i as q,q as C,f as L,j as F}from"./index-c4N2JW1k.js";import{_ as T}from"./_plugin-vue_export-helper-DlAUqK2U.js";const J={class:"card"},G={class:"card-header"},H=["title"],K={class:"app-description"},Q={class:"app-id-section"},W={class:"app-id"},X=V({__name:"ApplicationCard",props:{application_id:{},name:{},description:{}},setup(w){return(p,u)=>(v(),y("div",J,[e("div",G,[e("h2",{class:"app-name",title:p.name},x(p.name),9,H)]),e("p",K,x(p.description||"Описание недоступно"),1),e("div",Q,[u[0]||(u[0]=e("p",{class:"app-id-label"},"ID приложения:",-1)),e("div",W,x(p.application_id),1)]),u[1]||(u[1]=e("button",{class:"btn-primary btn-manage"},"Управление",-1))]))}}),Y=T(X,[["__scopeId","data-v-38adae94"]]),Z={class:"fixed inset-0 bg-white dark:bg-gray-900 z-50 overflow-auto p-6"},ee={class:"max-w-4xl mx-auto w-full"},te={class:"text-xl font-semibold text-gray-800 dark:text-white mb-4"},ae={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},oe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},se={class:"pt-4 flex justify-between flex-wrap gap-3"},le={key:0},ne={class:"flex gap-3 ml-auto"},ie=V({__name:"AddApplication",props:{modelValue:{}},emits:["update:modelValue","close","save","delete"],setup(w,{emit:p}){const u=()=>{a.id&&b("delete",a.id)},r=w,b=p,a=N({id:"",application_id:"",description:"",name:"",region:"",store_region:"",application_number:"",category:"",start_date:"",release_date:"",technology:""}),g=!!r.modelValue;M(()=>r.modelValue,m=>{var t,o;m?Object.assign(a,{...m,start_date:((t=m.start_date)==null?void 0:t.slice(0,10))??"",release_date:((o=m.release_date)==null?void 0:o.slice(0,10))??""}):Object.keys(a).forEach(k=>{a[k]=""})},{immediate:!0});const f=()=>{b("save",{...a})};return(m,t)=>(v(),y("div",Z,[e("div",ee,[e("h2",te,x(g?"Редактировать приложение":"Добавить приложение"),1),e("form",{onSubmit:E(f,["prevent"]),class:"space-y-5"},[e("div",null,[t[11]||(t[11]=e("label",{class:"label"},"Название",-1)),d(e("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>a.name=o),class:"input",placeholder:"Название приложения",required:""},null,512),[[c,a.name]])]),e("div",null,[t[12]||(t[12]=e("label",{class:"label"},"Bundle ID приложения",-1)),d(e("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>a.application_id=o),class:"input",placeholder:"ID приложения",required:""},null,512),[[c,a.application_id]])]),e("div",null,[t[13]||(t[13]=e("label",{class:"label"},"Описание приложения",-1)),d(e("input",{"onUpdate:modelValue":t[2]||(t[2]=o=>a.description=o),class:"input",placeholder:"Описание приложения",required:""},null,512),[[c,a.description]])]),e("div",null,[t[14]||(t[14]=e("label",{class:"label"},"Регион размещения",-1)),d(e("input",{"onUpdate:modelValue":t[3]||(t[3]=o=>a.region=o),class:"input",placeholder:"Напр. US, EU, RU"},null,512),[[c,a.region]])]),e("div",null,[t[15]||(t[15]=e("label",{class:"label"},"Регион App Store",-1)),d(e("input",{"onUpdate:modelValue":t[4]||(t[4]=o=>a.store_region=o),class:"input"},null,512),[[c,a.store_region]])]),e("div",ae,[e("div",null,[t[16]||(t[16]=e("label",{class:"label"},"ID Приложения",-1)),d(e("input",{"onUpdate:modelValue":t[5]||(t[5]=o=>a.application_number=o),class:"input"},null,512),[[c,a.application_number]])]),e("div",null,[t[17]||(t[17]=e("label",{class:"label"},"Категория",-1)),d(e("input",{"onUpdate:modelValue":t[6]||(t[6]=o=>a.category=o),class:"input"},null,512),[[c,a.category]])])]),e("div",oe,[e("div",null,[t[18]||(t[18]=e("label",{class:"label"},"Дата начала",-1)),d(e("input",{type:"date","onUpdate:modelValue":t[7]||(t[7]=o=>a.start_date=o),class:"input"},null,512),[[c,a.start_date]])]),e("div",null,[t[19]||(t[19]=e("label",{class:"label"},"Дата релиза",-1)),d(e("input",{type:"date","onUpdate:modelValue":t[8]||(t[8]=o=>a.release_date=o),class:"input"},null,512),[[c,a.release_date]])])]),e("div",null,[t[21]||(t[21]=e("label",{class:"label"},"Технология",-1)),d(e("select",{"onUpdate:modelValue":t[9]||(t[9]=o=>a.technology=o),class:"input"},t[20]||(t[20]=[e("option",{disabled:"",value:""},"Выберите тип",-1),e("option",null,"Native",-1),e("option",null,"Flutter",-1),e("option",null,"React Native",-1),e("option",null,"Swift",-1),e("option",null,"Python",-1)]),512),[[R,a.technology]])]),e("div",se,[g?(v(),y("div",le,[e("button",{type:"button",onClick:u,class:"px-4 py-2 rounded bg-red-600 text-white hover:bg-red-700"}," Удалить ")])):I("",!0),e("div",ne,[e("button",{type:"button",onClick:t[10]||(t[10]=o=>m.$emit("close")),class:"px-4 py-2 rounded bg-gray-300 hover:bg-gray-400 dark:bg-gray-700 dark:hover:bg-gray-600"}," Отмена "),t[22]||(t[22]=e("button",{type:"submit",class:"px-4 py-2 rounded bg-blue-600 text-white hover:bg-blue-700"}," Сохранить ",-1))])])],32)])]))}}),re=T(ie,[["__scopeId","data-v-39c4401a"]]),de={class:"min-h-screen bg-white dark:bg-gray-900"},pe={class:"border-b border-gray-100 dark:border-gray-800 bg-white dark:bg-gray-900"},ue={class:"max-w-7xl mx-auto px-4 py-4 flex gap-6"},ce={class:"max-w-7xl mx-auto px-4 py-6"},me={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5"},ve=V({__name:"ApplicationPage",setup(w){const p=L(),u=z(),r=$([]),b=$(!1),a=$(null),g=async l=>{try{if(!await u.refresh()){u.logout(),p.push("/login");return}await l()}catch(s){console.error("Ошибка выполнения действия:",s),p.push({name:"Error"})}},f=async()=>{await g(async()=>{const l=localStorage.getItem("accessToken"),s=await fetch("/dashboard/api/v1/store_applications",{headers:{Authorization:`Bearer ${l}`}});if(!s.ok)throw new Error("Ошибка загрузки приложений");const i=await s.json();r.value=i})},m=async l=>{await g(async()=>{const s=localStorage.getItem("accessToken"),i=await fetch("/dashboard/api/v1/store_applications",{method:"POST",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},body:JSON.stringify(l)});if(!i.ok)throw new Error("Ошибка при создании приложения");const n=await i.json();r.value.push(n)})},t=async l=>{await g(async()=>{const s=localStorage.getItem("accessToken"),i=await fetch(`/dashboard/api/v1/store_applications/${l.id}`,{method:"PUT",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},body:JSON.stringify(l)});if(!i.ok)throw new Error("Ошибка при обновлении приложения");const n=await i.json(),_=r.value.findIndex(B=>B.id===l.id);_!==-1&&(r.value[_]=n)})},o=async l=>{await g(async()=>{const s=localStorage.getItem("accessToken");if(!(await fetch(`/dashboard/api/v1/store_applications/${l}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}})).ok)throw new Error("Ошибка при удалении приложения");r.value=r.value.filter(n=>n.id!==l),await f(),h()})};function k(){a.value=null,b.value=!0}function j(l){a.value={...l},b.value=!0}function h(){b.value=!1,a.value=null}async function D(l){l.id?await t(l):await m(l),await f(),h()}return O(f),(l,s)=>{const i=F("RouterLink");return v(),y("div",de,[e("nav",pe,[e("div",ue,[A(i,{to:"/main",class:"text-sm font-medium text-gray-600 dark:text-gray-300 hover:text-blue-600 dark:hover:text-white","active-class":"text-blue-600 dark:text-white font-semibold underline underline-offset-4"},{default:S(()=>s[1]||(s[1]=[U(" Главная ")])),_:1}),A(i,{to:"/applications",class:"text-sm font-medium text-gray-600 dark:text-gray-300 hover:text-blue-600 dark:hover:text-white","active-class":"text-blue-600 dark:text-white font-semibold underline underline-offset-4"},{default:S(()=>s[2]||(s[2]=[U(" Приложения ")])),_:1})])]),e("header",{class:"border-b border-gray-100 dark:border-gray-800"},[e("div",{class:"max-w-7xl mx-auto px-4 py-6 flex flex-col md:flex-row justify-between items-start md:items-center gap-4"},[s[3]||(s[3]=e("div",null,[e("h1",{class:"text-xl font-normal text-gray-800 dark:text-gray-200"}," Приложения "),e("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"}," Управляйте своими приложениями и API-подключениями ")],-1)),e("button",{onClick:k,class:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg"}," + Добавить приложение ")])]),e("main",ce,[e("div",me,[(v(!0),y(P,null,q(r.value,n=>(v(),C(Y,{key:n.id,application_id:n.application_id,name:n.name,description:n.description,onClick:E(_=>j(n),["prevent"]),class:"cursor-pointer"},null,8,["application_id","name","description","onClick"]))),128))])]),b.value?(v(),C(re,{key:0,modelValue:a.value,"onUpdate:modelValue":s[0]||(s[0]=n=>a.value=n),onClose:h,onSave:D,onDelete:o},null,8,["modelValue"])):I("",!0)])}}});export{ve as default};
