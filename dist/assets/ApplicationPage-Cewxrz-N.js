import{d as _,a as m,c as v,b as e,t as x,l as B,m as N,e as I,w as d,v as p,n as M,p as T,r as h,o as z,g as V,h as A,k as S,q as U,F as O,i as P,s as C,R as E}from"./index-INCICDqM.js";import{_ as D}from"./_plugin-vue_export-helper-DlAUqK2U.js";const q={class:"card"},R={class:"card-header"},F=["title"],L={class:"app-description"},J={class:"app-id-section"},G={class:"app-id"},H=_({__name:"ApplicationCard",props:{application_id:{},name:{},description:{}},setup(y){return(i,r)=>(m(),v("div",q,[e("div",R,[e("h2",{class:"app-name",title:i.name},x(i.name),9,F)]),e("p",L,x(i.description||"Описание недоступно"),1),e("div",J,[r[0]||(r[0]=e("p",{class:"app-id-label"},"ID приложения:",-1)),e("div",G,x(i.application_id),1)]),r[1]||(r[1]=e("button",{class:"btn-primary btn-manage"},"Управление",-1))]))}}),K=D(H,[["__scopeId","data-v-38adae94"]]),Q={class:"fixed inset-0 bg-white dark:bg-gray-900 z-50 overflow-auto p-6"},W={class:"max-w-4xl mx-auto w-full"},X={class:"text-xl font-semibold text-gray-800 dark:text-white mb-4"},Y={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Z={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ee={class:"pt-4 flex justify-between flex-wrap gap-3"},te={key:0},ae={class:"flex gap-3 ml-auto"},oe=_({__name:"AddApplication",props:{modelValue:{}},emits:["update:modelValue","close","save","delete"],setup(y,{emit:i}){const r=()=>{a.id&&b("delete",a.id)},u=y,b=i,a=B({id:"",application_id:"",description:"",name:"",region:"",store_region:"",application_number:"",category:"",start_date:"",release_date:"",technology:""}),f=!!u.modelValue;N(()=>u.modelValue,c=>{var t,o;c?Object.assign(a,{...c,start_date:((t=c.start_date)==null?void 0:t.slice(0,10))??"",release_date:((o=c.release_date)==null?void 0:o.slice(0,10))??""}):Object.keys(a).forEach(k=>{a[k]=""})},{immediate:!0});const w=()=>{b("save",{...a})};return(c,t)=>(m(),v("div",Q,[e("div",W,[e("h2",X,x(f?"Редактировать приложение":"Добавить приложение"),1),e("form",{onSubmit:I(w,["prevent"]),class:"space-y-5"},[e("div",null,[t[11]||(t[11]=e("label",{class:"label"},"Название",-1)),d(e("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>a.name=o),class:"input",placeholder:"Название приложения",required:""},null,512),[[p,a.name]])]),e("div",null,[t[12]||(t[12]=e("label",{class:"label"},"Bundle ID приложения",-1)),d(e("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>a.application_id=o),class:"input",placeholder:"ID приложения",required:""},null,512),[[p,a.application_id]])]),e("div",null,[t[13]||(t[13]=e("label",{class:"label"},"Описание приложения",-1)),d(e("input",{"onUpdate:modelValue":t[2]||(t[2]=o=>a.description=o),class:"input",placeholder:"Описание приложения",required:""},null,512),[[p,a.description]])]),e("div",null,[t[14]||(t[14]=e("label",{class:"label"},"Регион размещения",-1)),d(e("input",{"onUpdate:modelValue":t[3]||(t[3]=o=>a.region=o),class:"input",placeholder:"Напр. US, EU, RU"},null,512),[[p,a.region]])]),e("div",null,[t[15]||(t[15]=e("label",{class:"label"},"Регион App Store",-1)),d(e("input",{"onUpdate:modelValue":t[4]||(t[4]=o=>a.store_region=o),class:"input"},null,512),[[p,a.store_region]])]),e("div",Y,[e("div",null,[t[16]||(t[16]=e("label",{class:"label"},"ID Приложения",-1)),d(e("input",{"onUpdate:modelValue":t[5]||(t[5]=o=>a.application_number=o),class:"input"},null,512),[[p,a.application_number]])]),e("div",null,[t[17]||(t[17]=e("label",{class:"label"},"Категория",-1)),d(e("input",{"onUpdate:modelValue":t[6]||(t[6]=o=>a.category=o),class:"input"},null,512),[[p,a.category]])])]),e("div",Z,[e("div",null,[t[18]||(t[18]=e("label",{class:"label"},"Дата начала",-1)),d(e("input",{type:"date","onUpdate:modelValue":t[7]||(t[7]=o=>a.start_date=o),class:"input"},null,512),[[p,a.start_date]])]),e("div",null,[t[19]||(t[19]=e("label",{class:"label"},"Дата релиза",-1)),d(e("input",{type:"date","onUpdate:modelValue":t[8]||(t[8]=o=>a.release_date=o),class:"input"},null,512),[[p,a.release_date]])])]),e("div",null,[t[21]||(t[21]=e("label",{class:"label"},"Технология",-1)),d(e("select",{"onUpdate:modelValue":t[9]||(t[9]=o=>a.technology=o),class:"input"},t[20]||(t[20]=[e("option",{disabled:"",value:""},"Выберите тип",-1),e("option",null,"Native",-1),e("option",null,"Flutter",-1),e("option",null,"React Native",-1),e("option",null,"Swift",-1),e("option",null,"Python",-1)]),512),[[M,a.technology]])]),e("div",ee,[f?(m(),v("div",te,[e("button",{type:"button",onClick:r,class:"px-4 py-2 rounded bg-red-600 text-white hover:bg-red-700"}," Удалить ")])):T("",!0),e("div",ae,[e("button",{type:"button",onClick:t[10]||(t[10]=o=>c.$emit("close")),class:"px-4 py-2 rounded bg-gray-300 hover:bg-gray-400 dark:bg-gray-700 dark:hover:bg-gray-600"}," Отмена "),t[22]||(t[22]=e("button",{type:"submit",class:"px-4 py-2 rounded bg-blue-600 text-white hover:bg-blue-700"}," Сохранить ",-1))])])],32)])]))}}),le=D(oe,[["__scopeId","data-v-39c4401a"]]),se={class:"min-h-screen bg-white dark:bg-gray-900"},ne={class:"border-b border-gray-100 dark:border-gray-800 bg-white dark:bg-gray-900"},ie={class:"max-w-7xl mx-auto px-4 py-4 flex gap-6"},re={class:"max-w-7xl mx-auto px-4 py-6"},de={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5"},ce=_({__name:"ApplicationPage",setup(y){const i=h([]),r=h(!1),u=h(null),b=async()=>{try{const l=localStorage.getItem("accessToken"),s=await fetch("/dashboard/api/v1/store_applications",{headers:{Authorization:`Bearer ${l}`}});if(!s.ok)throw new Error("Ошибка загрузки приложений");const n=await s.json();i.value=n}catch(l){console.error("Ошибка при получении приложений:",l)}},a=async l=>{const s=localStorage.getItem("accessToken"),n=await fetch("/dashboard/api/v1/store_applications",{method:"POST",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},body:JSON.stringify(l)});if(!n.ok)throw new Error("Ошибка при создании приложения");const g=await n.json();i.value.push(g)},f=async l=>{const s=localStorage.getItem("accessToken"),n=await fetch(`/dashboard/api/v1/store_applications/${l.id}`,{method:"PUT",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},body:JSON.stringify(l)});if(!n.ok)throw new Error("Ошибка при обновлении приложения");const g=await n.json(),$=i.value.findIndex(j=>j.id===l.id);$!==-1&&(i.value[$]=g)},w=async l=>{const s=localStorage.getItem("accessToken");if(!(await fetch(`/dashboard/api/v1/store_applications/${l}`,{method:"DELETE",headers:{Authorization:`Bearer ${s}`}})).ok)throw new Error("Ошибка при удалении приложения");i.value=i.value.filter(g=>g.id!==l),await b(),o()};function c(){u.value=null,r.value=!0}function t(l){u.value={...l},r.value=!0}function o(){r.value=!1,u.value=null}async function k(l){try{l.id?await f(l):await a(l),await b(),o()}catch(s){console.error("Ошибка сохранения:",s)}}return z(b),(l,s)=>(m(),v("div",se,[e("nav",ne,[e("div",ie,[V(U(E),{to:"/main",class:"text-sm font-medium text-gray-600 dark:text-gray-300 hover:text-blue-600 dark:hover:text-white","active-class":"text-blue-600 dark:text-white font-semibold underline underline-offset-4"},{default:A(()=>s[1]||(s[1]=[S(" Главная ")])),_:1}),V(U(E),{to:"/applications",class:"text-sm font-medium text-gray-600 dark:text-gray-300 hover:text-blue-600 dark:hover:text-white","active-class":"text-blue-600 dark:text-white font-semibold underline underline-offset-4"},{default:A(()=>s[2]||(s[2]=[S(" Приложения ")])),_:1})])]),e("header",{class:"border-b border-gray-100 dark:border-gray-800"},[e("div",{class:"max-w-7xl mx-auto px-4 py-6 flex flex-col md:flex-row justify-between items-start md:items-center gap-4"},[s[3]||(s[3]=e("div",null,[e("h1",{class:"text-xl font-normal text-gray-800 dark:text-gray-200"}," Приложения "),e("p",{class:"mt-1 text-sm text-gray-500 dark:text-gray-400"}," Управляйте своими приложениями и API-подключениями ")],-1)),e("button",{onClick:c,class:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg"}," + Добавить приложение ")])]),e("main",re,[e("div",de,[(m(!0),v(O,null,P(i.value,n=>(m(),C(K,{key:n.id,application_id:n.application_id,name:n.name,description:n.description,onClick:I(g=>t(n),["prevent"]),class:"cursor-pointer"},null,8,["application_id","name","description","onClick"]))),128))])]),r.value?(m(),C(le,{key:0,modelValue:u.value,"onUpdate:modelValue":s[0]||(s[0]=n=>u.value=n),onClose:o,onSave:k,onDelete:w},null,8,["modelValue"])):T("",!0)]))}});export{ce as default};
